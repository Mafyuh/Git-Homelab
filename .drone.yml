kind: pipeline
type: docker
name: Lint on PR

trigger:
  event:
    - pull_request

steps:
  - name: python3.8
    image: python:3.8-slim-bullseye
    commands:
      - "python3 --version"
      - "pip3 install yamllint"
      - "yamllint --version"
      - 'find . -name "*.yml" ! -name ".drone.yml" -exec yamllint -d "{extends: relaxed, rules: {line-length: {max: 120}}}" {} +'
      - 'find . -name "*.yaml" ! -name ".drone.yml" -exec yamllint -d "{extends: relaxed, rules: {line-length: {max: 120}}}" {} +'

  - name: python3.10
    image: python:3.9-slim-bullseye
    commands:
      - "python3 --version"
      - "pip3 install yamllint"
      - "yamllint --version"
      - 'find . -name "*.yml" ! -name ".drone.yml" -exec yamllint -d "{extends: relaxed, rules: {line-length: {max: 120}}}" {} +'
      - 'find . -name "*.yaml" ! -name ".drone.yml" -exec yamllint -d "{extends: relaxed, rules: {line-length: {max: 120}}}" {} +'

  - name: python3.12
    image: python:3.10-slim-bullseye
    commands:
      - "python3 --version"
      - "pip3 install yamllint"
      - "yamllint --version"
      - 'find . -name "*.yml" ! -name ".drone.yml" -exec yamllint -d "{extends: relaxed, rules: {line-length: {max: 120}}}" {} +'
      - 'find . -name "*.yaml" ! -name ".drone.yml" -exec yamllint -d "{extends: relaxed, rules: {line-length: {max: 120}}}" {} +'